'use strict';var Markdown={};
(function(){function n(m){return m}function A(){return!1}function s(){}function r(){}s.prototype={chain:function(m,g){var t=this[m];if(!t)throw Error("unknown hook "+m);this[m]=t===n?g:function(m){var o=Array.prototype.slice.call(arguments,0);o[0]=t.apply(null,o);return g.apply(null,o)}},set:function(m,g){if(!this[m])throw Error("unknown hook "+m);this[m]=g},addNoop:function(m){this[m]=n},addFalse:function(m){this[m]=A}};Markdown.HookCollection=s;r.prototype={set:function(m,g){this["s_"+m]=g},get:function(m){return this["s_"+
m]}};Markdown.Converter=function(){function m(a){return a=a.replace(/^[ ]{0,3}\[([^\[\]]+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?(?=\s|$)[ \t]*\n?[ \t]*((\n*)["(](.+?)[")][ \t]*)?(?:\n+)/gm,function(a,e,L,b,d,l){e=e.toLowerCase();G.set(e,c(L));if(d)return b;l&&H.set(e,l.replace(/"/g,"&quot;"));return""})}function g(a){a=a.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,n);a=a.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,
n);a=a.replace(/\n[ ]{0,3}((<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,n);a=a.replace(/\n\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \t]*(?=\n{2,}))/g,n);return a=a.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,n)}function n(a,c){var e;e=c.replace(/^\n+/,"");e=e.replace(/\n+$/g,"");return e="\n\n~K"+(I.push(e)-1)+"K\n\n"}function q(a,c){a=F.preBlockGamut(a,K);a=D(a);a=a.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,"<hr />\n");a=a.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \t]*$/gm,
"<hr />\n");a=a.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,"<hr />\n");a=j(a);a=E(a);a=b(a);a=F.postBlockGamut(a,K);a=g(a);return a=d(a,c)}function o(a){a=F.preSpanGamut(a);a=y(a);a=A(a);a=a.replace(/\\(\\)/g,z);a=a.replace(/\\([`*_{}\[\]()>#+-.!])/g,z);a=a.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,p);a=a.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,p);a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,w);a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?((?:\([^)]*\)|[^()\s])*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,
w);a=a.replace(/(\[([^\[\]]+)\])()()()()()/g,w);a=k(a);a=a.replace(/~P/g,"://");a=c(a);a=a.replace(/([\W_]|^)(\*\*|__)(?=\S)([^\r]*?\S[\*_]*)\2([\W_]|$)/g,"$1<strong>$3</strong>$4");a=a.replace(/([\W_]|^)(\*|_)(?=\S)([^\r\*_]*?\S)\2([\W_]|$)/g,"$1<em>$3</em>$4");a=a.replace(/  +\n/g," <br>\n");return a=F.postSpanGamut(a)}function A(a){return a=a.replace(/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi,function(a){var c=a.replace(/(.)<\/?code>(?=.)/g,"$1`");return c=
u(c,"!"==a.charAt(1)?"\\`*_/":"\\`*_")})}function w(a,c,e,b,d,k,f,z){void 0==z&&(z="");a=e.replace(/:\/\//g,"~P");b=b.toLowerCase();if(""==d)if(""==b&&(b=a.toLowerCase().replace(/ ?\n/g," ")),void 0!=G.get(b))d=G.get(b),void 0!=H.get(b)&&(z=H.get(b));else if(-1<c.search(/\(\s*\)$/m))d="";else return c;d=l(d);d=u(d,"*_");c='<a href="'+d+'"';""!=z&&(z=i(z),z=u(z,"*_"),c+=' title="'+z+'"');return c+(">"+a+"</a>")}function i(a){return a.replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}
function p(a,c,e,b,d,l,k,f){a=e;b=b.toLowerCase();f||(f="");if(""==d)if(""==b&&(b=a.toLowerCase().replace(/ ?\n/g," ")),void 0!=G.get(b))d=G.get(b),void 0!=H.get(b)&&(f=H.get(b));else return c;a=u(i(a),"*_[]()");d=u(d,"*_");c='<img src="'+d+'" alt="'+a+'"';f=i(f);f=u(f,"*_");return c+(' title="'+f+'"')+" />"}function D(a){a=a.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(a,c){return"<h1>"+o(c)+"</h1>\n\n"});a=a.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(a,c){return"<h2>"+o(c)+"</h2>\n\n"});return a=
a.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(a,c,e){a=c.length;return"<h"+a+">"+o(e)+"</h"+a+">\n\n"})}function j(a,c){var a=a+"~0",e=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;J?a=a.replace(e,function(a,e,b){a=-1<b.search(/[*+-]/g)?"ul":"ol";e=x(e,a,c);e=e.replace(/\s+$/,"");return"<"+a+">"+e+"</"+a+">\n"}):(e=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,a=a.replace(e,function(a,
c,e,b){a=-1<b.search(/[*+-]/g)?"ul":"ol";e=x(e,a);return c+"<"+a+">\n"+e+"</"+a+">\n"}));return a=a.replace(/~0/,"")}function x(a,c,e){J++;var a=a.replace(/\n{2,}$/,"\n"),c=M[c],b=!1,a=(a+"~0").replace(RegExp("(^[ \\t]*)("+c+")[ \\t]+([^\\r]+?(\\n+))(?=(~0|\\1("+c+")[ \\t]+))","gm"),function(a,c,d,l){a=l;(c=/\n\n$/.test(a))||-1<a.search(/\n{2,}/)||b?a=q(v(a),!0):(a=j(v(a),!0),a=a.replace(/\n$/,""),e||(a=o(a)));b=c;return"<li>"+a+"</li>\n"}),a=a.replace(/~0/g,"");J--;return a}function E(c){c=(c+"~0").replace(/(?:\n\n|^\n?)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,
function(c,e,b){c=a(v(e));c=C(c);c=c.replace(/^\n+/g,"");c=c.replace(/\n+$/g,"");return"\n\n"+("<pre><code>"+c+"\n</code></pre>")+"\n\n"+b});return c=c.replace(/~0/,"")}function h(a){a=a.replace(/(^\n+|\n+$)/g,"");return"\n\n~K"+(I.push(a)-1)+"K\n\n"}function y(c){return c=c.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(c,e,b,d){c=d.replace(/^([ \t]*)/g,"");c=c.replace(/[ \t]*$/g,"");c=a(c);c=c.replace(/:\/\//g,"~P");return e+"<code>"+c+"</code>"})}function a(a){a=a.replace(/&/g,"&amp;");
a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");return a=u(a,"*_{}[]\\",!1)}function b(a){return a=a.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(a,c){var e;e=c.replace(/^[ \t]*>[ \t]?/gm,"~0");e=e.replace(/~0/g,"");e=e.replace(/^[ \t]+$/gm,"");e=q(e);e=e.replace(/(^|\n)/g,"$1  ");e=e.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(a,c){var e;e=c.replace(/^  /mg,"~0");return e=e.replace(/~0/g,"")});return h("<blockquote>\n"+e+"\n</blockquote>")})}function d(a,c){for(var a=a.replace(/^\n+/g,
""),a=a.replace(/\n+$/g,""),e=a.split(/\n{2,}/g),b=[],d=/~K(\d+)K/,l=e.length,k=0;k<l;k++){var f=e[k];d.test(f)?b.push(f):/\S/.test(f)&&(f=o(f),f=f.replace(/^([ \t]*)/g,"<p>"),f+="</p>",b.push(f))}if(!c){l=b.length;for(k=0;k<l;k++)for(var u=!0;u;)u=!1,b[k]=b[k].replace(/~K(\d+)K/g,function(a,c){u=!0;return I[c]})}return b.join("\n\n")}function c(a){a=a.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;");return a=a.replace(/<(?![a-z\/?!]|~D)/gi,"&lt;")}function e(a,c,e,b){if(c)return a;if(")"!==
b.charAt(b.length-1))return"<"+e+b+">";for(var a=b.match(/[()]/g),d=c=0;d<a.length;d++)"("===a[d]?0>=c?c=1:c++:c--;var l="";0>c&&(b=b.replace(RegExp("\\){1,"+-c+"}$"),function(a){l=a;return""}));l&&(a=b.charAt(b.length-1),N.test(a)||(l=a+l,b=b.substr(0,b.length-1)));return"<"+e+b+">"+l}function k(a){a=a.replace(O,e);return a=a.replace(/<((https?|ftp):[^'">\s]+)>/gi,function(a,c){return'<a href="'+c+'">'+F.plainLinkText(c)+"</a>"})}function f(a){return a=a.replace(/~E(\d+)E/g,function(a,c){var e=parseInt(c);
return String.fromCharCode(e)})}function v(a){a=a.replace(/^(\t|[ ]{1,4})/gm,"~0");return a=a.replace(/~0/g,"")}function C(a){if(!/\t/.test(a))return a;var c=["    ","   ","  "," "],e=0,b;return a.replace(/[\n\t]/g,function(a,d){if("\n"===a)return e=d+1,a;b=(d-e)%4;e=d+1;return c[b]})}function l(a){if(!a)return"";var c=a.length;return a.replace(P,function(e,b){return"~D"==e?"%24":":"==e&&(b==c-1||/[0-9\/]/.test(a.charAt(b+1)))?":":"%"+e.charCodeAt(0).toString(16)})}function u(a,c,e){c="(["+c.replace(/([\[\]\\])/g,
"\\$1")+"])";e&&(c="\\\\"+c);return a=a.replace(RegExp(c,"g"),z)}function z(a,c){return"~E"+c.charCodeAt(0)+"E"}var F=this.hooks=new s;F.addNoop("plainLinkText");F.addNoop("preConversion");F.addNoop("postNormalization");F.addNoop("preBlockGamut");F.addNoop("postBlockGamut");F.addNoop("preSpanGamut");F.addNoop("postSpanGamut");F.addNoop("postConversion");var G,H,I,J;this.makeHtml=function(a){if(G)throw Error("Recursive call to converter.makeHtml");G=new r;H=new r;I=[];J=0;a=F.preConversion(a);a=a.replace(/~/g,
"~T");a=a.replace(/\$/g,"~D");a=a.replace(/\r\n/g,"\n");a=a.replace(/\r/g,"\n");a=C("\n\n"+a+"\n\n");a=a.replace(/^[ \t]+$/mg,"");a=F.postNormalization(a);a=g(a);a=m(a);a=q(a);a=f(a);a=a.replace(/~D/g,"$$");a=a.replace(/~T/g,"~");a=F.postConversion(a);I=H=G=null;return a};var K=function(a){return q(a)},M={ol:"\\d+[.]",ul:"[*+-]"},O=/(="|<)?\b(https?|ftp)(:\/\/[-A-Z0-9+&@#/%?=~_|[\]()!:,.;]*[-A-Z0-9+&@#/%=~_|[\])])(?=$|\W)/gi,N=/[-A-Z0-9+&@#/%=~_|[\])]/i,P=/(?:["'*()[\]:]|~D)/g}})();
(function(){var n,A,s;function r(){}function m(a){this.buttonBar=j.getElementById("wmd-button-bar"+a);this.preview=j.getElementById("wmd-preview"+a);this.input=j.getElementById("wmd-input"+a)}function g(a,b){var d=this,c=[],e=0,k="none",f,v,C,l=function(a,c){k!=a&&(k=a,c||z());!n||"moving"!=k?v=setTimeout(u,1):C=null},u=function(a){C=new t(b,a);v=void 0};this.setCommandMode=function(){k="command";z();v=setTimeout(u,0)};this.canUndo=function(){return 1<e};this.canRedo=function(){return c[e+1]?!0:!1};
this.undo=function(){d.canUndo()&&(f?(f.restore(),f=null):(c[e]=new t(b),c[--e].restore(),a&&a()));k="none";b.input.focus();u()};this.redo=function(){d.canRedo()&&(c[++e].restore(),a&&a());k="none";b.input.focus();u()};var z=function(){var d=C||new t(b);if(!d)return!1;"moving"==k?f||(f=d):(f&&(c[e-1].text!=f.text&&(c[e++]=f),f=null),c[e++]=d,c[e+1]=null,a&&a())},F=function(a){var c=!1;if((a.ctrlKey||a.metaKey)&&!a.altKey)switch(String.fromCharCode(a.charCode||a.keyCode).toLowerCase()){case "y":d.redo();
c=!0;break;case "z":a.shiftKey?d.redo():d.undo(),c=!0}c&&(a.preventDefault&&a.preventDefault(),window.event&&(window.event.returnValue=!1))},h=function(a){!a.ctrlKey&&!a.metaKey&&(a=a.keyCode,33<=a&&40>=a||63232<=a&&63235>=a?l("moving"):8==a||46==a||127==a?l("deleting"):13==a?l("newlines"):27==a?l("escape"):(16>a||20<a)&&91!=a&&l("typing"))};(function(){i.addEvent(b.input,"keypress",function(a){(a.ctrlKey||a.metaKey)&&!a.altKey&&(89==a.keyCode||90==a.keyCode)&&a.preventDefault()});var a=function(){if((n||
C&&C.text!=b.input.value)&&void 0==v)k="paste",z(),u()};i.addEvent(b.input,"keydown",F);i.addEvent(b.input,"keydown",h);i.addEvent(b.input,"mousedown",function(){l("moving")});b.input.onpaste=a;b.input.ondrop=a})();u(!0);z()}function t(a,b){var d=this,c=a.input;this.init=function(){if(i.isVisible(c)&&(b||!(j.activeElement&&j.activeElement!==c)))if(this.setInputAreaSelectionStartEnd(),this.scrollTop=c.scrollTop,!this.text&&c.selectionStart||0===c.selectionStart)this.text=c.value};this.setInputAreaSelection=
function(){if(i.isVisible(c))if(void 0!==c.selectionStart&&!A)c.focus(),c.selectionStart=d.start,c.selectionEnd=d.end,c.scrollTop=d.scrollTop;else if(j.selection&&!(j.activeElement&&j.activeElement!==c)){c.focus();var a=c.createTextRange();a.moveStart("character",-c.value.length);a.moveEnd("character",-c.value.length);a.moveEnd("character",d.end);a.moveStart("character",d.start);a.select()}};this.setInputAreaSelectionStartEnd=function(){if(!a.ieCachedRange&&(c.selectionStart||0===c.selectionStart))d.start=
c.selectionStart,d.end=c.selectionEnd;else if(j.selection){d.text=i.fixEolChars(c.value);var e=a.ieCachedRange||j.selection.createRange(),b=i.fixEolChars(e.text),f="\u0007"+b+"\u0007";e.text=f;var v=i.fixEolChars(c.value);e.moveStart("character",-f.length);e.text=b;d.start=v.indexOf("\u0007");d.end=v.lastIndexOf("\u0007")-1;if(f=d.text.length-i.fixEolChars(c.value).length){for(e.moveStart("character",-b.length);f--;)b+="\n",d.end+=1;e.text=b}a.ieCachedRange&&(d.scrollTop=a.ieCachedScrollTop);a.ieCachedRange=
null;this.setInputAreaSelection()}};this.restore=function(){void 0!=d.text&&d.text!=c.value&&(c.value=d.text);this.setInputAreaSelection();c.scrollTop=d.scrollTop};this.getChunks=function(){var a=new r;a.before=i.fixEolChars(d.text.substring(0,d.start));a.startTag="";a.selection=i.fixEolChars(d.text.substring(d.start,d.end));a.endTag="";a.after=i.fixEolChars(d.text.substring(d.end));a.scrollTop=d.scrollTop;return a};this.setChunks=function(a){a.before+=a.startTag;a.after=a.endTag+a.after;this.start=
a.before.length;this.end=a.before.length+a.selection.length;this.text=a.before+a.selection+a.after;this.scrollTop=a.scrollTop};this.init()}function q(a,b,d){var c,e,k,f=function(){var a=0;window.innerHeight?a=window.pageYOffset:j.documentElement&&j.documentElement.scrollTop?a=j.documentElement.scrollTop:j.body&&(a=j.body.scrollTop);return a},v=function(){if(b.preview){var c=b.input.value;if(!(c&&c==k)){k=c;var d=(new Date).getTime(),c=a.makeHtml(c);e=(new Date).getTime()-d;H(c)}}},C=function(){c&&
(clearTimeout(c),c=void 0);var a=0,a=e;3E3<a&&(a=3E3);c=setTimeout(v,a)};this.refresh=function(a){a?(k="",v()):C()};this.processingTime=function(){return e};var l=!0,u=function(a){var c=b.preview,e=c.parentNode,d=c.nextSibling;e.removeChild(c);c.innerHTML=a;d?e.insertBefore(c,d):e.appendChild(c)},z=function(a){b.preview.innerHTML=a},h,G=function(a){if(h)return h(a);try{z(a),h=z}catch(c){h=u,h(a)}},H=function(a){var c=p.getTop(b.input)-f();b.preview&&(G(a),d());b.preview&&(b.preview.scrollTop=(b.preview.scrollHeight-
b.preview.clientHeight)*(b.preview.scrollHeight<=b.preview.clientHeight?1:b.preview.scrollTop/(b.preview.scrollHeight-b.preview.clientHeight)));if(l)l=!1;else{var e=p.getTop(b.input)-f();n?setTimeout(function(){window.scrollBy(0,e-c)},0):window.scrollBy(0,e-c)}};(function(a,c){i.addEvent(a,"input",c);a.onpaste=c;a.ondrop=c;i.addEvent(a,"keypress",c);i.addEvent(a,"keydown",c)})(b.input,C);v();b.preview&&(b.preview.scrollTop=0)}function o(a,b,d,c,e,k,f){var v,C,l,u,z,h,G,H,y,p,m,o;function g(a){w.focus();
if(a.textOp){d&&d.setCommandMode();var e=new t(b);if(!e)return;var l=e.getChunks(),k=function(){w.focus();l&&e.setChunks(l);e.restore();c.refresh()};a.textOp(l,k)||k()}a.execute&&a.execute(d)}function q(a,c){var e=a.getElementsByTagName("span")[0];c?(e.style.backgroundPosition=a.XShift+" 0px",a.onmouseover=function(){e.style.backgroundPosition=this.XShift+" -40px"},a.onmouseout=function(){e.style.backgroundPosition=this.XShift+" 0px"},n&&(a.onmousedown=function(){j.activeElement&&j.activeElement!==
b.input||(b.ieCachedRange=document.selection.createRange(),b.ieCachedScrollTop=b.input.scrollTop)}),a.isHelp||(a.onclick=function(){if(this.onmouseout)this.onmouseout();g(this);return!1})):(e.style.backgroundPosition=a.XShift+" -20px",a.onmouseover=a.onmouseout=a.onclick=function(){})}function r(a){"string"===typeof a&&(a=e[a]);return function(){a.apply(e,arguments)}}function s(){d&&(q(m,d.canUndo()),q(o,d.canRedo()))}var w=b.input;v=void 0;C=void 0;l=void 0;u=void 0;z=void 0;h=void 0;G=void 0;H=
void 0;y=void 0;p=void 0;m=void 0;o=void 0;(function(){var c=b.buttonBar,e=document.createElement("ul");e.id="wmd-button-row"+a;e.className="wmd-button-row";var e=c.appendChild(e),d=0,c=function(c,b,l,k){var f=document.createElement("li");f.className="wmd-button";f.style.left=d+"px";d+=25;var u=document.createElement("span");f.id=c+a;f.appendChild(u);f.title=b;f.XShift=l;k&&(f.textOp=k);q(f,!0);e.appendChild(f);return f},j=function(c){var b=document.createElement("li");b.className="wmd-spacer wmd-spacer"+
c;b.id="wmd-spacer"+c+a;e.appendChild(b);d+=25};v=c("wmd-bold-button",f("bold"),"0px",r("doBold"));C=c("wmd-italic-button",f("italic"),"-20px",r("doItalic"));j(1);l=c("wmd-link-button",f("link"),"-40px",r(function(a,c){return this.doLinkOrImage(a,c,!1)}));u=c("wmd-quote-button",f("quote"),"-60px",r("doBlockquote"));z=c("wmd-code-button",f("code"),"-80px",r("doCode"));h=c("wmd-image-button",f("image"),"-100px",r(function(a,c){return this.doLinkOrImage(a,c,!0)}));j(2);G=c("wmd-olist-button",f("olist"),
"-120px",r(function(a,c){this.doList(a,c,!0)}));H=c("wmd-ulist-button",f("ulist"),"-140px",r(function(a,c){this.doList(a,c,!1)}));y=c("wmd-heading-button",f("heading"),"-160px",r("doHeading"));p=c("wmd-hr-button",f("hr"),"-180px",r("doHorizontalRule"));j(3);m=c("wmd-undo-button",f("undo"),"-200px",null);m.execute=function(a){a&&a.undo()};j=/win/.test(E.platform.toLowerCase())?f("redo"):f("redomac");o=c("wmd-redo-button",j,"-220px",null);o.execute=function(a){a&&a.redo()};k&&(c=document.createElement("li"),
j=document.createElement("span"),c.appendChild(j),c.className="wmd-button wmd-help-button",c.id="wmd-help-button"+a,c.XShift="-240px",c.isHelp=!0,c.style.right="0px",c.title=f("help"),c.onclick=k.handler,q(c,!0),e.appendChild(c));s()})();var x="keydown";A&&(x="keypress");i.addEvent(w,x,function(a){if((a.ctrlKey||a.metaKey)&&!a.altKey&&!a.shiftKey){switch(String.fromCharCode(a.charCode||a.keyCode).toLowerCase()){case "b":g(v);break;case "i":g(C);break;case "l":g(l);break;case "q":g(u);break;case "k":g(z);
break;case "g":g(h);break;case "o":g(G);break;case "u":g(H);break;case "h":g(y);break;case "r":g(p);break;case "y":g(o);break;case "z":a.shiftKey?g(o):g(m);break;default:return}a.preventDefault&&a.preventDefault();window.event&&(window.event.returnValue=!1)}});i.addEvent(w,"keyup",function(a){if(a.shiftKey&&!a.ctrlKey&&!a.metaKey&&13===(a.charCode||a.keyCode))a={},a.textOp=r("doAutoindent"),g(a)});n&&i.addEvent(w,"keydown",function(a){if(27===a.keyCode)return!1});this.setUndoRedoButtonStates=s}function B(a,
b){this.hooks=a;this.getString=b}function w(a){return a.replace(/^\s*(.*?)(?:\s+"(.+)")?\s*$/,function(a,d,c){d=d.replace(/\?.*$/,function(a){return a.replace(/\+/g," ")});d=decodeURIComponent(d);d=encodeURI(d).replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29");d=d.replace(/\?.*$/,function(a){return a.replace(/\+/g,"%2b")});c&&(c=c.trim?c.trim():c.replace(/^\s*/,"").replace(/\s*$/,""),c=c.replace(/"/g,"quot;").replace(/\(/g,"&#40;").replace(/\)/g,"&#41;").replace(/</g,"&lt;").replace(/>/g,
"&gt;"));return c?d+' "'+c+'"':d})}var i={},p={},D={},j=window.document,x=window.RegExp,E=window.navigator;n=/msie/.test(E.userAgent.toLowerCase());s=/msie 6/.test(E.userAgent.toLowerCase())||/msie 5/.test(E.userAgent.toLowerCase());A=/opera/.test(E.userAgent.toLowerCase());var h={bold:"Strong <strong> Ctrl+B",boldexample:"strong text",italic:"Emphasis <em> Ctrl+I",italicexample:"emphasized text",link:"Hyperlink <a> Ctrl+L",linkdescription:"enter link description here",linkdialog:'<p><b>Insert Hyperlink</b></p><p>http://example.com/ "optional title"</p>',
quote:"Blockquote <blockquote> Ctrl+Q",quoteexample:"Blockquote",code:"Code Sample <pre><code> Ctrl+K",codeexample:"enter code here",image:"Image <img> Ctrl+G",imagedescription:"enter image description here",imagedialog:'<p><b>Insert Image</b></p><p>http://example.com/images/diagram.jpg "optional title"<br><br>'+function(a){return"Need "+a.startAnchor+"free image hosting?"+a.endAnchor}({startAnchor:"<a href='http://www.google.com/search?q=free+image+hosting' target='_blank'>",endAnchor:"</a>"})+"</p>",
olist:"Numbered List <ol> Ctrl+O",ulist:"Bulleted List <ul> Ctrl+U",litem:"List item",heading:"Heading <h1>/<h2> Ctrl+H",headingexample:"Heading",hr:"Horizontal Rule <hr> Ctrl+R",undo:"Undo - Ctrl+Z",redo:"Redo - Ctrl+Y",redomac:"Redo - Ctrl+Shift+Z",help:"Markdown Editing Help"};Markdown.Editor=function(a,b,d){d=d||{};"function"===typeof d.handler&&(d={helpButton:d});d.strings=d.strings||{};d.helpButton&&(d.strings.help=d.strings.help||d.helpButton.title);var c=function(a){return d.strings[a]||h[a]},
b=b||"",e=this.hooks=new Markdown.HookCollection;e.addNoop("onPreviewRefresh");e.addNoop("postBlockquoteCreation");e.addFalse("insertImageDialog");this.getConverter=function(){return a};var k=this,f;this.run=function(){if(!f){f=new m(b);var h=new B(e,c),C=new q(a,f,function(){e.onPreviewRefresh()}),l,u;/\?noundo/.test(j.location.href)||(l=new g(function(){C.refresh();u&&u.setUndoRedoButtonStates()},f),this.textOperation=function(a){l.setCommandMode();a();k.refreshPreview()});u=new o(b,f,l,C,h,d.helpButton,
c);u.setUndoRedoButtonStates();(k.refreshPreview=function(){C.refresh(!0)})()}}};r.prototype.findTags=function(a,b){var d=this,c;a&&(c=i.extendRegExp(a,"","$"),this.before=this.before.replace(c,function(a){d.startTag+=a;return""}),c=i.extendRegExp(a,"^",""),this.selection=this.selection.replace(c,function(a){d.startTag+=a;return""}));b&&(c=i.extendRegExp(b,"","$"),this.selection=this.selection.replace(c,function(a){d.endTag=a+d.endTag;return""}),c=i.extendRegExp(b,"^",""),this.after=this.after.replace(c,
function(a){d.endTag=a+d.endTag;return""}))};r.prototype.trimWhitespace=function(a){var b,d=this;a?a=b="":(a=function(a){d.before+=a;return""},b=function(a){d.after=a+d.after;return""});this.selection=this.selection.replace(/^(\s*)/,a).replace(/(\s*)$/,b)};r.prototype.skipLines=function(a,b,d){void 0===a&&(a=1);void 0===b&&(b=1);a++;b++;var c,e;navigator.userAgent.match(/Chrome/)&&"X".match(/()./);this.selection=this.selection.replace(/(^\n*)/,"");this.startTag+=x.$1;this.selection=this.selection.replace(/(\n*$)/,
"");this.endTag+=x.$1;this.startTag=this.startTag.replace(/(^\n*)/,"");this.before+=x.$1;this.endTag=this.endTag.replace(/(\n*$)/,"");this.after+=x.$1;if(this.before){for(c=e="";a--;)c+="\\n?",e+="\n";d&&(c="\\n*");this.before=this.before.replace(new x(c+"$",""),e)}if(this.after){for(c=e="";b--;)c+="\\n?",e+="\n";d&&(c="\\n*");this.after=this.after.replace(new x(c,""),e)}};i.isVisible=function(a){if(window.getComputedStyle)return"none"!==window.getComputedStyle(a,null).getPropertyValue("display");
if(a.currentStyle)return"none"!==a.currentStyle.display};i.addEvent=function(a,b,d){a.attachEvent?a.attachEvent("on"+b,d):a.addEventListener(b,d,!1)};i.removeEvent=function(a,b,d){a.detachEvent?a.detachEvent("on"+b,d):a.removeEventListener(b,d,!1)};i.fixEolChars=function(a){a=a.replace(/\r\n/g,"\n");return a=a.replace(/\r/g,"\n")};i.extendRegExp=function(a,b,d){if(null===b||void 0===b)b="";if(null===d||void 0===d)d="";var a=a.toString(),c,a=a.replace(/\/([gim]*)$/,function(a,b){c=b;return""}),a=a.replace(/(^\/|\/$)/g,
"");return new x(b+a+d,c)};p.getTop=function(a,b){var d=a.offsetTop;if(!b)for(;a=a.offsetParent;)d+=a.offsetTop;return d};p.getHeight=function(a){return a.offsetHeight||a.scrollHeight};p.getWidth=function(a){return a.offsetWidth||a.scrollWidth};p.getPageSize=function(){var a,b,d,c;self.innerHeight&&self.scrollMaxY?(a=j.body.scrollWidth,b=self.innerHeight+self.scrollMaxY):j.body.scrollHeight>j.body.offsetHeight?(a=j.body.scrollWidth,b=j.body.scrollHeight):(a=j.body.offsetWidth,b=j.body.offsetHeight);
self.innerHeight?(d=self.innerWidth,c=self.innerHeight):j.documentElement&&j.documentElement.clientHeight?(d=j.documentElement.clientWidth,c=j.documentElement.clientHeight):j.body&&(d=j.body.clientWidth,c=j.body.clientHeight);a=Math.max(a,d);b=Math.max(b,c);return[a,b,d,c]};D.createBackground=function(){var a=j.createElement("div"),b=a.style;a.className="wmd-prompt-background";b.position="absolute";b.top="0";b.zIndex="1000";n?b.filter="alpha(opacity=50)":b.opacity="0.5";var d=p.getPageSize();b.height=
d[1]+"px";n?(b.left=j.documentElement.scrollLeft,b.width=j.documentElement.clientWidth):(b.left="0",b.width="100%");j.body.appendChild(a);return a};D.prompt=function(a,b,d){var c,e;void 0===b&&(b="");var k=function(a){if(27===(a.charCode||a.keyCode))return a.stopPropagation&&a.stopPropagation(),f(!0),!1},f=function(a){i.removeEvent(j.body,"keyup",k);var b=e.value;a?b=null:(b=b.replace(/^http:\/\/(https?|ftp):\/\//,"$1://"),/^(?:https?|ftp):\/\//.test(b)||(b="http://"+b));c.parentNode.removeChild(c);
d(b);return!1},h=function(){c=j.createElement("div");c.className="wmd-prompt-dialog";c.style.padding="10px;";c.style.position="fixed";c.style.width="400px";c.style.zIndex="1001";var d=j.createElement("div");d.innerHTML=a;d.style.padding="5px";c.appendChild(d);var d=j.createElement("form"),l=d.style;d.onsubmit=function(){return f(!1)};l.padding="0";l.margin="0";l.cssFloat="left";l.width="100%";l.textAlign="center";l.position="relative";c.appendChild(d);e=j.createElement("input");e.type="text";e.value=
b;l=e.style;l.display="block";l.width="80%";l.marginLeft=l.marginRight="auto";d.appendChild(e);var u=j.createElement("input");u.type="button";u.onclick=function(){return f(!1)};u.value="OK";l=u.style;l.margin="10px";l.display="inline";l.width="7em";var z=j.createElement("input");z.type="button";z.onclick=function(){return f(!0)};z.value="Cancel";l=z.style;l.margin="10px";l.display="inline";l.width="7em";d.appendChild(u);d.appendChild(z);i.addEvent(j.body,"keyup",k);c.style.top="50%";c.style.left=
"50%";c.style.display="block";s&&(c.style.position="absolute",c.style.top=j.documentElement.scrollTop+200+"px",c.style.left="50%");j.body.appendChild(c);c.style.marginTop=-(p.getHeight(c)/2)+"px";c.style.marginLeft=-(p.getWidth(c)/2)+"px"};setTimeout(function(){h();var a=b.length;if(void 0!==e.selectionStart)e.selectionStart=0,e.selectionEnd=a;else if(e.createTextRange){var c=e.createTextRange();c.collapse(!1);c.moveStart("character",-a);c.moveEnd("character",a);c.select()}e.focus()},0)};var y=B.prototype;
y.prefixes="(?:\\s{4,}|\\s*>|\\s*-\\s+|\\s*\\d+\\.|=|\\+|-|_|\\*|#|\\s*\\[[^\n]]+\\]:)";y.unwrap=function(a){var b=new x("([^\\n])\\n(?!(\\n|"+this.prefixes+"))","g");a.selection=a.selection.replace(b,"$1 $2")};y.wrap=function(a,b){this.unwrap(a);var d=new x("(.{1,"+b+"})( +|$\\n?)","gm"),c=this;a.selection=a.selection.replace(d,function(a,b){return(new x("^"+c.prefixes,"")).test(a)?a:b+"\n"});a.selection=a.selection.replace(/\s+$/,"")};y.doBold=function(a,b){return this.doBorI(a,b,2,this.getString("boldexample"))};
y.doItalic=function(a,b){return this.doBorI(a,b,1,this.getString("italicexample"))};y.doBorI=function(a,b,d,c){a.trimWhitespace();a.selection=a.selection.replace(/\n{2,}/g,"\n");var e=/(\**$)/.exec(a.before)[0],b=/(^\**)/.exec(a.after)[0],e=Math.min(e.length,b.length);e>=d&&(2!=e||1!=d)?(a.before=a.before.replace(x("[*]{"+d+"}$",""),""),a.after=a.after.replace(x("^[*]{"+d+"}",""),"")):!a.selection&&b?(a.after=a.after.replace(/^([*_]*)/,""),a.before=a.before.replace(/(\s?)$/,""),a.before=a.before+
b+x.$1):(!a.selection&&!b&&(a.selection=c),d=1>=d?"*":"**",a.before+=d,a.after=d+a.after)};y.stripLinkDefs=function(a,b){return a=a.replace(/^[ ]{0,3}\[(\d+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|$)/gm,function(a,c,e,k,f){b[c]=a.replace(/\s*$/,"");return k?(b[c]=a.replace(/["(](.+?)[")]$/,""),k+f):""})};y.addLinkDef=function(a,b){var d=0,c={};a.before=this.stripLinkDefs(a.before,c);a.selection=this.stripLinkDefs(a.selection,c);a.after=this.stripLinkDefs(a.after,
c);var e="",k=/(\[)((?:\[[^\]]*\]|[^\[\]])*)(\][ ]?(?:\n[ ]*)?\[)(\d+)(\])/g,f=function(a){d++;a=a.replace(/^[ ]{0,3}\[(\d+)\]:/,"  ["+d+"]:");e+="\n"+a},h=function(a,b,e,j,g,i){e=e.replace(k,h);return c[g]?(f(c[g]),b+e+j+d+i):a};a.before=a.before.replace(k,h);b?f(b):a.selection=a.selection.replace(k,h);var j=d;a.after=a.after.replace(k,h);a.after&&(a.after=a.after.replace(/\n*$/,""));a.after||(a.selection=a.selection.replace(/\n*$/,""));a.after+="\n\n"+e;return j};y.doLinkOrImage=function(a,b,d){a.trimWhitespace();
a.findTags(/\s*!?\[/,/\][ ]?(?:\n[ ]*)?(\[.*?\])?/);var c;if(1<a.endTag.length&&0<a.startTag.length)a.startTag=a.startTag.replace(/!?\[/,""),a.endTag="",this.addLinkDef(a,null);else if(a.selection=a.startTag+a.selection+a.endTag,a.startTag=a.endTag="",/\n\n/.test(a.selection))this.addLinkDef(a,null);else{var e=this,k=function(f){c.parentNode.removeChild(c);null!==f&&(a.selection=(" "+a.selection).replace(/([^\\](?:\\\\)*)(?=[[\]])/g,"$1\\").substr(1),f=" [999]: "+w(f),f=e.addLinkDef(a,f),a.startTag=
d?"![":"[",a.endTag="]["+f+"]",a.selection||(a.selection=d?e.getString("imagedescription"):e.getString("linkdescription")));b()};c=D.createBackground();d?this.hooks.insertImageDialog(k)||D.prompt(this.getString("imagedialog"),"http://",k):D.prompt(this.getString("linkdialog"),"http://",k);return!0}};y.doAutoindent=function(a){var b=!1;a.before=a.before.replace(/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]*\n$/,"\n\n");a.before=a.before.replace(/(\n|^)[ ]{0,3}>[ \t]*\n$/,"\n\n");a.before=a.before.replace(/(\n|^)[ \t]+\n$/,
"\n\n");!a.selection&&!/^[ \t]*(?:\n|$)/.test(a.after)&&(a.after=a.after.replace(/^[^\n]*/,function(b){a.selection=b;return""}),b=!0);/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]+.*\n$/.test(a.before)&&this.doList&&this.doList(a);/(\n|^)[ ]{0,3}>[ \t]+.*\n$/.test(a.before)&&this.doBlockquote&&this.doBlockquote(a);/(\n|^)(\t|[ ]{4,}).*\n$/.test(a.before)&&this.doCode&&this.doCode(a);b&&(a.after=a.selection+a.after,a.selection="")};y.doBlockquote=function(a){a.selection=a.selection.replace(/^(\n*)([^\r]+?)(\n*)$/,
function(c,b,e,d){a.before+=b;a.after=d+a.after;return e});a.before=a.before.replace(/(>[ \t]*)$/,function(c,b){a.selection=b+a.selection;return""});a.selection=a.selection.replace(/^(\s|>)+$/,"");a.selection=a.selection||this.getString("quoteexample");var b="",d="",c;if(a.before){for(var e=a.before.replace(/\n$/,"").split("\n"),k=!1,f=0;f<e.length;f++){var h=!1;c=e[f];k=k&&0<c.length;/^>/.test(c)?(h=!0,!k&&1<c.length&&(k=!0)):h=/^[ \t]*$/.test(c)?!0:k;h?b+=c+"\n":(d+=b+c,b="\n")}/(^|\n)>/.test(b)||
(d+=b,b="")}a.startTag=b;a.before=d;a.after&&(a.after=a.after.replace(/^\n?/,"\n"));a.after=a.after.replace(/^(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*)/,function(c){a.endTag=c;return""});b=function(c){var b=c?"> ":"";a.startTag&&(a.startTag=a.startTag.replace(/\n((>|\s)*)\n$/,function(a,c){return"\n"+c.replace(/^[ ]{0,3}>?[ \t]*$/gm,b)+"\n"}));a.endTag&&(a.endTag=a.endTag.replace(/^\n((>|\s)*)\n/,function(a,c){return"\n"+c.replace(/^[ ]{0,3}>?[ \t]*$/gm,b)+"\n"}))};/^(?![ ]{0,3}>)/m.test(a.selection)?
(this.wrap(a,70),a.selection=a.selection.replace(/^/gm,"> "),b(!0),a.skipLines()):(a.selection=a.selection.replace(/^[ ]{0,3}> ?/gm,""),this.unwrap(a),b(!1),!/^(\n|^)[ ]{0,3}>/.test(a.selection)&&a.startTag&&(a.startTag=a.startTag.replace(/\n{0,2}$/,"\n\n")),!/(\n|^)[ ]{0,3}>.*$/.test(a.selection)&&a.endTag&&(a.endTag=a.endTag.replace(/^\n{0,2}/,"\n\n")));a.selection=this.hooks.postBlockquoteCreation(a.selection);/\n/.test(a.selection)||(a.selection=a.selection.replace(/^(> *)/,function(c,b){a.startTag+=
b;return""}))};y.doCode=function(a){var b=/\S[ ]*$/.test(a.before);if(!/^[ ]*\S/.test(a.after)&&!b||/\n/.test(a.selection)){a.before=a.before.replace(/[ ]{4}$/,function(c){a.selection=c+a.selection;return""});var d=b=1;/(\n|^)(\t|[ ]{4,}).*\n$/.test(a.before)&&(b=0);/^\n(\t|[ ]{4,})/.test(a.after)&&(d=0);a.skipLines(b,d);a.selection?/^[ ]{0,3}\S/m.test(a.selection)?/\n/.test(a.selection)?a.selection=a.selection.replace(/^/gm,"    "):a.before+="    ":a.selection=a.selection.replace(/^(?:[ ]{4}|[ ]{0,3}\t)/gm,
""):(a.startTag="    ",a.selection=this.getString("codeexample"))}else a.trimWhitespace(),a.findTags(/`/,/`/),!a.startTag&&!a.endTag?(a.startTag=a.endTag="`",a.selection||(a.selection=this.getString("codeexample"))):a.endTag&&!a.startTag?(a.before+=a.endTag,a.endTag=""):a.startTag=a.endTag=""};y.doList=function(a,b,d){var b=/^\n*(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*/,c="-",e=1,k=function(){var a;d?(a=" "+e+". ",e++):a=" "+c+" ";return a},f=function(a){void 0===
d&&(d=/^\s*\d/.test(a));return a=a.replace(/^[ ]{0,3}([*+-]|\d+[.])\s/gm,function(){return k()})};a.findTags(/(\n|^)*[ ]{0,3}([*+-]|\d+[.])\s+/,null);a.before&&!/\n$/.test(a.before)&&!/^\n/.test(a.startTag)&&(a.before+=a.startTag,a.startTag="");if(a.startTag){var h=/\d+[.]/.test(a.startTag);a.startTag="";a.selection=a.selection.replace(/\n[ ]{4}/g,"\n");this.unwrap(a);a.skipLines();h&&(a.after=a.after.replace(b,f));if(d==h)return}var j=1;a.before=a.before.replace(/(\n|^)(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*$/,
function(a){/^\s*([*+-])/.test(a)&&(c=x.$1);j=/[^\n]\n\n[^\n]/.test(a)?1:0;return f(a)});a.selection||(a.selection=this.getString("litem"));var h=k(),l=1;a.after=a.after.replace(b,function(a){l=/[^\n]\n\n[^\n]/.test(a)?1:0;return f(a)});a.trimWhitespace(!0);a.skipLines(j,l,!0);a.startTag=h;b=h.replace(/./g," ");this.wrap(a,72-b.length);a.selection=a.selection.replace(/\n/g,"\n"+b)};y.doHeading=function(a){a.selection=a.selection.replace(/\s+/g," ");a.selection=a.selection.replace(/(^\s+|\s+$)/g,"");
if(a.selection){var b=0;a.findTags(/#+[ ]*/,/[ ]*#+/);/#+/.test(a.startTag)&&(b=x.lastMatch.length);a.startTag=a.endTag="";a.findTags(null,/\s?(-+|=+)/);/=+/.test(a.endTag)&&(b=1);/-+/.test(a.endTag)&&(b=2);a.startTag=a.endTag="";a.skipLines(1,1);b=0==b?2:b-1;if(0<b){var b=2<=b?"-":"=",d=a.selection.length;72<d&&(d=72);for(a.endTag="\n";d--;)a.endTag+=b}}else a.startTag="## ",a.selection=this.getString("headingexample"),a.endTag=" ##"};y.doHorizontalRule=function(a){a.startTag="----------\n";a.selection=
"";a.skipLines(2,1,!0)}})();
(function(){function n(){for(var a=0;a<x.length;a++)x[a].refreshPreview()}function A(a){var c=a.match(/^\s*>\s*!/mg);if(c&&c.length==a.split("\n").length){var b=!1,a=a.replace(/(.*) (\w)/,function(a,c,e){b=!0;return c+"\n> "+e});b||(a=a.replace(/^(\s*>\s*)!/m,"$1&#33;"))}return a}function s(a){var c=/^\s*?[^\s!]/m,b=/^\s*?!/gm;return a=a.replace(/\<blockquote\>[\n\s]*?\<p\>[\n\s]*?(![\s\S]*?)\<\/p\>[\n\s]*?\<\/blockquote\>/g,function(a,e){if(c.test(e))return a;a=a.replace(e,e.replace(b,""));return a=
a.replace("<blockquote>",'<blockquote class="spoiler">')})}function r(a){if(!window.tagRendererRaw)return a;var c,b;return a=a.replace(StackExchange.options.site.nonAsciiTags?/\[(meta-)?tag:([a-z0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF#+.-]+)\]/gi:/\[(meta-)?tag:([a-z0-9#+.-]+)\]/gi,function(e,d,f,k){if(!j&&d)return e;if(!c){for(var h=a,g=[],i=/<(a|code)[^>]*>/ig,v;null!=(v=i.exec(h));){g.push(v.index);v=RegExp("</"+v[1]+">","ig");v.lastIndex=i.lastIndex;if(null==v.exec(h))break;g.push(v.lastIndex);
i.lastIndex=v.lastIndex}c=g;b=c.length}h=!1;for(g=0;g<b&&!(c[g]>k);g++)h=!h;if(h)return e;e=null;j&&!d&&(e=D);return tagRendererRaw(sanitizeAndSplitTags(f)[0],e)})}function m(a){var c,b;"undefined"==typeof y&&(y=StackExchange.options.styleCode);y&&(c=o(a),b=o(c+a),a=w(a,c,b));a=g(a);y&&(a=i(a,c,b));return a}function g(a){return a.replace(/<[^>]*>?/gi,t)}function t(c){return c.match(a)||c.match(b)||c.match(d)?c:""}function q(a){if(""==a)return"";var c=/<\/?\w+[^>]*(\s|$|>)/g,b=a.toLowerCase().match(c),
e=(b||[]).length;if(0==e)return a;for(var d,f,k,h=[],j=[],g=!1,i=0;i<e;i++)if(d=b[i].replace(/<\/?(\w+).*/,"$1"),!(h[i]||-1<"<p><img><br><li><hr>".search("<"+d+">"))){f=b[i];k=-1;if(!/^<\//.test(f))for(f=i+1;f<e;f++)if(!h[f]&&b[f]=="</"+d+">"){k=f;break}-1==k?g=j[i]=!0:h[k]=!0}if(!g)return a;i=0;return a=a.replace(c,function(a){a=j[i]?"":a;i++;return a})}function o(a){a=(a.match(/~/g)||[]).length;return Array(a+2).join("~")}function B(a){if(/^lang-/.test(a))return a;var b="c_"+a,d=c[b];if(d)return d;
if(e[b])return null;e[b]=!0;b=k.length;0<b&&RegExp("^"+k[b-1]).test(a)?k[b-1]=a:k.push(a);f.trigger();return null}function w(a,c,b){a=a.replace(v,function(a,b,e){return c+b+c+e});return a.replace(C,function(a,c){return b+c+b})}function i(a,c,b){var a=a.replace(RegExp(c+"([a-z0-9#+.-]+)"+c+"(\\s*?<pre)","gi"),function(a,c,b){a=B(c);return!a?b:b+" class='"+a+" prettyprint-override'"}),e;return a.replace(RegExp("("+b+"([a-z0-9#+.-]+)"+b+")|(<pre><code>)","gi"),function(a,c,b){if(c)return e=b,"";if(!e)return a;
c=B(e);return!c?a:"<pre class='"+c+" prettyprint-override'><code>"})}function p(a){function c(){d.animate({height:f.height()-k})}function b(a){if(f)a();else if(!i){i=!0;var e=v.offset();k=e.top-$("#wmd-button-row"+g).offset().top-$("#wmd-button-row"+g).outerHeight()-5;h=$("#wmd-help-button"+g);var l=h.offset().left+h.outerWidth(),e=e.left,m=v.outerWidth()+e,m=Math.max(l,m);j={right:l-m,width:m-e,top:$("#wmd-button-row"+g).outerHeight()+5};h.addClass("active-help");d=$("<div style='clear:both' />").insertBefore(v);
f=$('<div id="mdhelp'+g+'" class="mdhelp"><ul id="mdhelp-tabs'+g+'" class="mdhelp-tabs"><li /></ul></div>').find("li").addSpinner().end().css(j).insertAfter(h);c();$.get("/posts/markdown-help",{postfix:g}).done(function(b){f.remove();f=$(b).insertAfter(h).css(j);$("#mdhelp-tabs"+g).delegate("li:not(:last-child)","click",function(){var a=$(this).hasClass("selected");f.find(".mdhelp-tab").hide();$("#mdhelp-tabs"+g+" li").removeClass("selected");if(!a&&($("#"+$(this).attr("data-tab")).show(),$(this).addClass("selected"),
a=$(this).attr("data-buttons")))for(var a=a.split(","),b=0;b<a.length;b++){var e=$("#wmd-"+a[b]+"-button"+g);e.is(":animated")||e.animate({top:-15},400).animate({top:0},400).animate({top:-8},300).animate({top:0},300).animate({top:-4},200).animate({top:0},200).animate({top:-2},100).animate({top:0},100).animate({top:-1},50).animate({top:0},50)}c()});i=!1;a()})}}function e(){m=!0;b(function(){h.addClass("active-help");f.show();c()})}var d,f,k,h,j,i=!1,g=(a||{}).postfix||"",v=$("#wmd-input"+g),m=!1;this.toggle=
function(){f&&f.is(":visible")?(f.hide(),d.animate({height:0}),h.removeClass("active-help")):e()};this.showOnce=function(){m||e()}}if(!StackExchange.MarkdownEditor){var D,j,x=[],E=function(a){function c(a){return"facebook.stackoverflow.com"===a?"stackoverflow.com":a}function b(c){window.apiCallbacks[c]||(window.apiCallbacks[c]=function(b){if(b)if(b.error_message)/^No site found/.test(b.error_message)&&(v["s_"+c]=!0);else if(b.items){for(var b=b.items,e=b.length,d=0;d<e;d++){var f=b[d];h[c+"|"+f.question_id]=
f.title}a&&a()}});return'apiCallbacks["'+c+'"]'}function e(a,b){if(c(a)===k)return!0;var d=m[a];d||(d=m[a]={count:0,ids:{}});if(d.ids[b])return!0;if(d.count>=o)return!1;d.count++;return d.ids[b]=!0}var d=/<a href="((\S+)\/q(?:uestions)?\/(\d+)(?:|\/\S*?))">\1<\/a>/g,f=window.location.hostname.toLowerCase(),k=c(f),h={},g={},j={},i=StackExchange.helpers.DelayedReaction(function(){var a=!1,e;for(e in j)if(j.hasOwnProperty(e)){var d=b(e),f;30<j[e].length?f=j[e].splice(0,30).join(";"):(f=j[e].join(";"),
delete j[e]);a=!0;$.ajax({url:"http://api.stackexchange.com/2.0/questions/"+f+"?pagesize=30&key=6AU78DZ)GcdjNjAszYmTLQ((&filter=!6G7RPxWUNTleV&site="+c(e),crossDomain:!0,jsonpCallback:d,dataType:"jsonp"});break}a&&i.trigger()},1E3,{sliding:!0}),v={};window.apiCallbacks={};var m={},o=/^meta\./.test(k)?40:10;return function(a){m={};return a.replace(d,function(a,b,d,f){d=d.toLowerCase().replace(/^http:\/\//,"");if(/[^a-z0-9.]/.test(d)||!e(d,f))return a;var l=h[d+"|"+f];if(l)f=l;else{if(l=!g[d+"|"+f]){l=
c(d);if(l===k)l=!1;else if(v["s_"+l])l=!0;else var m=/^meta\./.test(k),l=k==="meta."+l||!m&&"meta."+k===l||m&&"meta.stackoverflow.com"==l||"meta.stackoverflow.com"===k?!1:!0;l=!l}l&&(g[d+"|"+f]=!0,(l=j[d])||(l=j[d]=[]),l.push(f),i.trigger());f=null}return!f?a:'<a href="'+b+'">'+f+"</a>"})}}(n),h=$.Callbacks();StackExchange.MarkdownEditor=function(a){var c=a.postfix||"";(j=StackExchange.options.site.isMetaStackOverflow||StackExchange.options.site.isChildMeta)&&(D=StackExchange.options.site.parentUrl||
"//www.stackoverflow.com");var b=new Markdown.Converter,e=b.hooks;e.addNoop("preSafe");e.chain("postConversion",E);e.chain("postConversion",function(a){return e.preSafe(a)});e.chain("postConversion",m);e.chain("postConversion",q);e.chain("postConversion",s);e.chain("postConversion",r);var d=new p({postfix:c}),f={helpButton:{handler:d.toggle}};a.noCode&&(f.strings={code:"Preformatted text <pre><code> Ctrl-K",codeexample:"enter preformatted text here"});b=new Markdown.Editor(b,c,f);b.hooks.chain("postBlockquoteCreation",
A);StackExchange.options.disableImageUploads||b.hooks.set("insertImageDialog",StackExchange.imageUploader.uploadImageDialog);h.fire(b,a.postfix);var k=$("#wmd-preview"+c);b.hooks.chain("onPreviewRefresh",function(){k.trigger("wmdrefresh")});x.push(b);b.run();if(a.immediatelyShowMarkdownHelp)d.showOnce(a);else if(a.autoShowMarkdownHelp)$("#wmd-input"+c).one("focus",function(){d.showOnce(a)});b.disableSubmission=function(){$("#submit-button"+c).attr("disabled","disabled");StackExchange.navPrevention.stop()};
return b};StackExchange.MarkdownEditor.creationCallbacks=h;StackExchange.MarkdownEditor.refreshAllPreviews=n;var y;StackExchange.MarkdownEditor.sanitizeHtml=g;var a=/^(<\/?(b|blockquote|code|del|dd|dl|dt|em|h1|h2|h3|i|kbd|li|ol|p|pre|s|sup|sub|strong|strike|ul)>|<(br|hr)\s?\/?>)$/i,b=/^(<a\shref="((https?|ftp):\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\stitle="[^"<>]+")?\s?>|<\/a>)$/i,d=/^(<img\ssrc="(https?:\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\swidth="\d{1,3}")?(\sheight="\d{1,3}")?(\salt="[^"<>]*")?(\stitle="[^"<>]*")?\s?\/?>)$/i;
StackExchange.MarkdownEditor.balanceTags=q;var c={},e={},k=[],f=StackExchange.helpers.DelayedReaction(function(){0!=k.length&&($.ajax("/api/tags/"+encodeURIComponent(k.join(";"))+"/syntax-highlight",{cache:!0}).done(function(a){var b=!1,e;for(e in a)a.hasOwnProperty(e)&&(c["c_"+e]=a[e],b=!0);b&&(StackExchange.MarkdownEditor.refreshAllPreviews(),styleCode())}),k=[])},2E3,{sliding:!0}),v=/<\!-- language: ([a-z0-9#+\-.]+) --\>(\s*?<pre>\s*?<code>)/gi,C=/<\!-- language-all: ([a-z0-9#+\-.]+) --\>/gi}})();
StackExchange.editor=function(){var n=function(n){var n=n||{},s=n.postfix||"",r=n.heartbeatType,m=n.bindNavPrevention,g=$("#post-form"+s),t=$("#wmd-input"+s),q;q=$("#title, #edit-comment, #m-address, .edit-comment");s=q.add(".tag-editor input");g.submit(function(){q.each(function(){StackExchange.helpers.hideHelpOverlay($(this))});StackExchange.helpers.disableSubmitButton(g);StackExchange.navPrevention.stop();return!0});$(".original-question").not(".processed").TextAreaResizer();t.not(".processed").TextAreaResizer();
t.typeWatch({highlight:!1,wait:5E3,captureLength:5,callback:styleCode});var o=new StackExchange.MarkdownEditor(n);if(r){var B=n.discardSelector?$(n.discardSelector):null;StackExchange.cardiologist.addHeart(r,t,o,B,n.postId)}if("ask"==r||"answer"==r){var w=t.add(s),i=function(){StackExchange.helpers.loadTicks(g);w.unbind("keydown",i);return!0};w.bind("keydown",i)}m&&StackExchange.navPrevention.init(t);g.find(".wmd-preview").click(function(g){2!=g.which&&$(this).siblings().find("textarea").focus()});
StackExchange.helpers.bindHelpOverlayEvents(q);0==$("#ask-page-has-errors").length&&$("#title").is("input")&&$("#title").focus();if(n.oncreated)n.oncreated(o);if(n.discardSelector&&("ask"==r||"answer"==r||"moderatormessage"==r)){var p=$(n.discardSelector);p.click(function(g){g.preventDefault();if(confirm("Are you sure you want to discard your draft?"))return $("#title").val("").blur(),$("#question-suggestions").empty(),$("#wmd-input-42").val(""),$("#wmd-preview-42").html(""),$("#answer-from-ask").is(":visible")&&
$("#answer-from-ask").is(":checked")&&$("#answer-from-ask").click(),g=$("#tagnames"),0<g.length&&g[0].func_clear&&(g[0].func_clear(),g.blur()),t.val("").blur(),o.refreshPreview(),$.post("/post/discard-draft",{fkey:StackExchange.options.user.fkey,postType:r},function(){$("#draft-saved").hide();$("#draft-discarded").show();var g=null,g=function(){$("#draft-discarded").hide();$("#title").unbind("keypress",g);t.unbind("keypress",g)};$("#title").bind("keypress",g);t.bind("keypress",g)}),p.hide(),!1})}};
return{init:n,initIfShown:function(A){var s=(A||{}).postfix||"";0!=$("#wmd-preview"+s).length&&("-42"!==s||0===$("#answer-from-ask").length)&&0===$("#show-editor-button"+s).length?(n(A),StackExchange.editor.finallyInit||(StackExchange.editor.finallyInit=function(){})):StackExchange.editor.finallyInit=function(){n(A)}}}}();
StackExchange.cardiologist=function(){function n(h){h="number"===typeof h?h:1E3*(B+w);D&&(h=Math.max(h,6E3-((new Date).getTime()-D)));j&&clearTimeout(j);j=setTimeout(A,h)}function A(){j=null;if(!t.length){var h;t=[];g&&!g.isDisabled&&30>g.beatCount&&t.push(g);for(var i=0;i<m.length;i++)h=m[i],h!=g&&!h.isDisabled&&30>h.beatCount&&t.push(h);B=Math.max(15,Math.min(45,60/(t.length||1)))}t.length?(h=t.shift(),h.checkActive()?h.beat():n()):n()}function s(){}function r(h){var g=[];$.get("/questions/"+h,
function(a){a=$(a);a.find("div.answer").each(function(){var a=this.id.substring(7);0==$("#answer-"+a).length&&g.push(this.id)});if(0<g.length){var b="#"+g.join(",#"),a=a.find(b),b=$("div.answer:last");0==b.length&&(b=$("#answers-header"));a.hide();b.after(a);a.fadeIn("slow");b=$("div.answer").length;$(".subheader h2").text(b+" Answer"+(1<b?"s":""));StackExchange.vote.init(h);StackExchange.comments.init({post:a})}StackExchange.notify.close(p);i=!1},"html")}var m=[],g,t=[],q,o,B=45,w=0,i=!1,p=-2,D,
j,x={ask:function(h){if(h.relatedQuestions){var g=$("#how-to-format"),a=h.relatedQuestions!=o;a&&g.hide();g.empty().append("<h4>Similar Questions</h4>"+h.relatedQuestions);a&&showFadingHelpText(g);o=h.relatedQuestions}h.suggestedTags&&StackExchange.tagSuggestions&&StackExchange.tagSuggestions.suggest(h.suggestedTags)},answer:function(h,g){if(h&&!i)if(h.disableEditor)StackExchange.notify.show("This question has been "+h.message+" - no more answers will be accepted.",p),i=!0;else{var a=parseInt(h.message);
0<a&&(a=function(a){return 1==a.count?a.count+" new answer has been posted - "+a.startAnchor+"load new answers."+a.endAnchor:a.count+" new answers have been posted - "+a.startAnchor+"load new answers."+a.endAnchor}({count:a,startAnchor:'<a id="load-new-answers">',endAnchor:"</a>"}),StackExchange.notify.show(a,p),i=!0,$("#load-new-answers").click(function(){r(g.postId)}))}},edit:function(h){h&&h.message&&StackExchange.notify.getMessageText(p)!=$("<span />").html(h.message).text()&&(StackExchange.notify.close(p),
StackExchange.notify.show(h.message,p))},moderatormessage:function(){}};s.prototype={activate:function(){g=this;this.isActive||(this.isActive=!0,this.beatCount=0,m.push(this),1===m.length&&n())},checkActive:function(){if(!this.isActive||this.isDisabled)return!1;return!this.jTextarea.closest("body").length?(delete this.jTextarea,this.isDisabled=!0,!1):!0},beat:function(h){var g=this,a={type:"POST",url:"/posts/"+this.postId+"/editor-heartbeat/"+this.type,dataType:"json",data:{}};h||(a.success=function(a){g.success(a)},
a.error=function(){g.error()},a.complete=function(){g.complete()});if(this.shouldSendDraft()){var b={text:this.jTextarea.val()};"ask"===this.type&&(b.title=$("#title").val(),b.tagnames=$("#tagnames").val(),b.answertext=$("#wmd-input-42").val());if(!q||q.heart!==this||q.title!==b.title||q.tagnames!==b.tagnames||q.text!==b.text||q.answertext!==b.answertext)a.data=b,q={heart:this,title:b.title,tagnames:b.tagnames,text:b.text,answertext:b.answertext}}if(h&&!("text"in a.data))return $.Deferred().resolve().promise();
this.revisionGuid&&(a.data.clientRevisionGuid=this.revisionGuid);"answer"===this.type&&(h=$("#answers-header .answers-subheader h2").text().replace(/ answers?/i,"")||"0",a.data.clientCount=h);D=(new Date).getTime();return $.ajax(a).promise()},shouldSendDraft:function(){return"edit"!==this.type&&g===this},success:function(h){x[this.type](h,this);h.disableEditor&&(this.editor.disableSubmission(),this.isDisabled=!0);h.draftSaved&&E(this.jTextarea,this.discardDraftLink);this.beatCount++;w=0},error:function(){$("#draft-saved").hide();
g===this&&t.unshift(this);w=(new Date).getTime()%100/10},complete:function(){n()}};var E=function(h,g){var a=$("#draft-saved"),b=function(){a.text("draft saved").fadeIn("fast")};a.is(":visible")?a.fadeOut("fast",b):b();g&&g.removeClass("dno").show();var d=function(a){if(115!=a.which||!a.ctrlKey||a.shiftKey||a.altKey)h.unbind("keypress",d),$("#draft-saved").fadeOut("fast")};h.bind("keypress",d);$("#draft-discarded").hide()};return{addHeart:function(g,i,a,b,d){var c=new s,e;c.type=g;c.jTextarea=i;c.discardDraftLink=
b;switch(g){case "ask":e=0;break;case "answer":e=$("#post-id").val()||location.href.match(/\/questions\/(\d+)/i)[1];break;case "edit":e=d||$("#post-id").val()||i.closest(".question, .answer").find(".vote input").val();g=i.closest(".inline-post");b=null;0<g.length&&(b=g[0].action.split("/").pop());b||(b=$("#client-revision-guid").val());c.revisionGuid=b;break;case "moderatormessage":e=+$("#moderator-message-to-user").attr("data-userid")}c.postId=e;c.editor=a;i.keypress(function(){c.activate()})},ensureDraftSaved:function(h,
i){!g||!g.checkActive()?h():g.beat(i).done(h)},beatASAP:function(){n(1)},notifiedOfNewAnswer:function(){i=!0},isHeartBeating:function(){if(null==m)return!1;for(var g=0;g<m.length;g++)if(!0==m[g].checkActive())return!0;return!1}}}();
StackExchange.navPrevention=function(){var n,A,s=function(){var g=!1;n.each(function(m){g=g||$(this).val()!==A[m]});return g},r=function(g){window.onbeforeunload=g?function(){if(n&&s())return g}:null},m=function(){r("You have started writing or editing a post.")};return{init:function(g){n=g.one("keypress",m);A=[];g.each(function(){A.push($(this).val())})},start:function(){n&&m()},stop:function(){n&&(n.unbind("keypress",m),r(null),n=null)},confirm:function(g){return n&&s()?confirm(g):!0}}}();
(function(n){function A(o){m=n(o.data.el);m.blur();t=o.clientY+document.documentElement.scrollTop;g=m.height()-t;m.css("opacity",0.25);n(document).mousemove(s).mouseup(r);return!1}function s(n){var s=n.clientY+document.documentElement.scrollTop,w=g+s;t>=s&&(w-=5);t=s;w=Math.max(q,w);m.height(w+"px");w<q&&r(n);return!1}function r(){n(document).unbind("mousemove",s).unbind("mouseup",r);m.css("opacity",1);m.focus();g=m=null;t=0}var m,g,t=0,q=32;n.fn.TextAreaResizer=function(){return this.each(function(){m=
n(this).addClass("processed");g=null;n(this).parent().append(n('<div class="grippie"></div>').bind("mousedown",{el:this},A));var o=n("div.grippie",n(this).parent())[0];o.style.marginRight=o.offsetWidth-n(this)[0].offsetWidth+"px"})}})(jQuery);"use strict";
StackExchange.imageUploader=function(){var n={};return{uploadImageDialog:function(A,s){var r="upload-iframe-"+(new Date).getTime();"undefined"===typeof s&&(s="/upload/image");var m=window.FileReader&&window.FormData,g=m&&"ondrop"in window,t=m&&"onpaste"in document.body&&window.Clipboard,m="/render/image-upload?uploadUrl={0}&canDragDrop={1}&canPaste={2}".formatUnicorn(encodeURIComponent(s),g?"true":"false",t?"true":"false"),q=$('<div class="popup" id="image-upload" style="z-index:1010; width: 420px;" tabindex="-1"></div>').addClass("async-load").data("load-url",
m),o,B,w,i=function(a){if(27===(a.charCode||a.keyCode))return p(null),!1},p=function(a){q&&q.fadeOutAndRemove();$("body").unbind("keyup",i);$("body").unbind("paste");void 0!==a&&A(a);B&&B.fadeOutAndRemove();return!1},D=function(a){p();B=$('<div class="popup" id="image-upload" style="z-index:1010;"></div>').addClass("async-load").data("load-url","/render/image-upload/preview");B.appendTo("#header").center().fadeIn("fast");$("body").bind("keyup",i);B.asyncLoad({callback:function(){B.find("#image-preview").attr("src",
a);e(B);StackExchange.helpers.bindMovablePopups();d()},cache:n})},j=function(a){a=a||window.event;a.preventDefault&&a.preventDefault();o.style.backgroundColor="white";w=a.dataTransfer.files[0];a=new window.FileReader;a.onloadend=x;a.readAsDataURL(w);return!1},x=function(a){D(a.target.result)},E=function(a){a=a.originalEvent||window.event;if(a.clipboardData&&(a=a.clipboardData.items))for(var c=0;c<a.length;c++)if(-1!==a[c].type.indexOf("image")){w=a[c].getAsFile();var b=(window.URL||window.webkitURL).createObjectURL(w);
D(b)}},h=function(){return!1},y=function(){return!1},a=function(){c(B);if(window.FormData){var a=new window.FormData;a.append("uploadedImage",w);a.append("fkey",StackExchange.options.user.fkey);$.ajax({url:s,data:a,cache:!1,contentType:!1,processData:!1,type:"POST",success:function(a){$("#"+r).contents().find("html").html(a)}})}},b=function(){o=document.getElementById("image-upload");g&&(o.ondrop=j,o.ondragover=y,o.ondragleave=h);t&&$("body").bind("paste",E);q.find(".popup-close").click(function(){p(null)});
q.find(":radio").change(function(){var a=q.find("#filename-input"),c=q.find("#url-wrapper");a.toggle();c.toggle();$("#upload-message").css({color:"inherit",fontWeight:"inherit"}).hide().text("");c.is(":visible")&&q.find("#url-input").focus()});q.find("form").submit(function(){c(q);var a=q.find(":radio:checked").val(),b=q.find("#filename-input"),e=q.find("#url-wrapper"),d;if("web"==a){var g=b.next();b.detach();d=function(){b.insertBefore(g)}}else{var h=e.next();e.detach();d=function(){e.insertBefore(h)}}this.target=
r;window.closeDialog=p;window.displayUploadError=function(a){$("#upload-message").css({color:"red",fontWeight:"bold"}).show().text(a);d();d=null};return!0});q.find("#filename-input").focus()},d=function(){B.find(".popup-close").click(function(){p(null)});$("#cancel-upload").click(function(){p(null)});$("#confirm-upload").click(a);window.closeDialog=p;window.displayUploadError=function(a){$("#upload-message").css({color:"red",fontWeight:"bold"}).show().text(a)}},c=function(a){a=a.find("#upload-message");
a.text(a.data("uploading-text")).addSpinner()},e=function(a){$('<iframe style="display: none;" src="about:blank" />').attr("id",r).attr("name",r).appendTo(a)};q.appendTo("#header").center().fadeIn("fast").promise().done(function(){q.asyncLoad({callback:function(){e(q);StackExchange.helpers.bindMovablePopups();StackExchange.helpers.bindHelpOverlayEvents($("#url-input"));b()},cache:n})});$("body").bind("keyup",i);return!0}}}();
StackExchange.postValidation=function(){function n(a,b,d){var f=a.find('input[type="submit"]:visible'),h=f.length&&f.is(":enabled");h&&f.attr("disabled",!0);s(a);r(a,b,d);g(a);t(a);q(a);var i=function(){1!=b||a.find(E).length?(m(a),h&&f.attr("disabled",!1)):setTimeout(i,250)};i()}function A(){for(var a=0;a<b.length;a++)clearTimeout(b[a]);b=[]}function s(a){var e=a.find(j);e.length&&e.blur(function(){b.push(setTimeout(function(){var b=e.val(),d=$.trim(b);if(0==d.length)p(a,e);else{var g=e.data("min-length");
g&&d.length<g?i(e,[function(a){return 1==a.minLength?"Title must be at least "+a.minLength+" character.":"Title must be at least "+a.minLength+" characters."}({minLength:g})],o()):(g=e.data("max-length"))&&d.length>g?i(e,[function(a){return 1==a.maxLength?"Title cannot be longer than "+a.maxLength+" character.":"Title cannot be longer than "+a.maxLength+" characters."}({maxLength:g})],o()):$.ajax({type:"POST",url:"/posts/validate-title",data:{title:b},success:function(b){b.success?p(a,e):i(e,b.errors.Title,
o())},error:function(){p(a,e)}})}},d))})}function r(a,e,g){var f=a.find(x);f.length&&f.blur(function(){b.push(setTimeout(function(){var b=f.val(),d=$.trim(b);0==d.length?p(a,f):5==e?(b=f.data("min-length"))&&d.length<b?i(f,[function(a){return"Wiki Body must be at least "+a.minLength+" characters. You entered "+a.actual+"."}({minLength:b,actual:d.length})],o()):p(a,f):(1==e||2==e)&&$.ajax({type:"POST",url:"/posts/validate-body",data:{body:b,oldBody:f.prop("defaultValue"),isQuestion:1==e,isSuggestedEdit:g},
success:function(b){b.success?p(a,f):i(f,b.errors.Body,o())},error:function(){p(a,f)}})},d))})}function m(a){var e=a.find(E);if(e.length){var g=e.parent().find("input#tagnames");g.blur(function(){b.push(setTimeout(function(){var b=g.val();0==$.trim(b).length?p(a,e):$.ajax({type:"POST",url:"/posts/validate-tags",data:{tags:b,oldTags:g.prop("defaultValue")},success:function(b){b.success?p(a,e):i(e,b.errors.Tags,o())},error:function(){p(a,e)}})},d))})}}function g(a){var e=a.find(h);e.length&&e.blur(function(){b.push(setTimeout(function(){var b=
e.val(),b=$.trim(b);if(0==b.length)p(a,e);else{var d=e.data("min-length");d&&b.length<d?i(e,[function(a){return 1==a.minLength?"Your edit summary must be at least "+a.minLength+" character.":"Your edit summary must be at least "+a.minLength+" characters."}({minLength:d})],o()):(d=e.data("max-length"))&&b.length>d?i(e,[function(a){return 1==a.maxLength?"Your edit summary cannot be longer than "+a.maxLength+" character.":"Your edit summary cannot be longer than "+a.maxLength+" characters."}({maxLength:d})],
o()):p(a,e)}},d))})}function t(a){var e=a.find(y);e.length&&e.blur(function(){b.push(setTimeout(function(){var b=e.val(),b=$.trim(b);if(0==b.length)p(a,e);else{var d=e.data("min-length");d&&b.length<d?i(e,[function(a){return"Wiki Excerpt must be at least "+a.minLength+" characters; you entered "+a.actual+"."}({minLength:d,actual:b.length})],o()):(d=e.data("max-length"))&&b.length>d?i(e,[function(a){return"Wiki Excerpt cannot be longer than "+a.maxLength+" characters; you entered "+a.actual+"."}({maxLength:d,
actual:b.length})],o()):p(a,e)}},d))})}function q(c){var e=c.find(a);e.length&&e.blur(function(){b.push(setTimeout(function(){var a=e.val();0==$.trim(a).length?p(c,e):/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,20}$/i.test(a)?p(c,e):i(e,["This email does not appear to be valid."],B())},d))})}function o(){var a=$("#sidebar, .sidebar").first().width()||270;return{position:{my:"left top",at:"right center"},css:{"max-width":a,"min-width":a},closeOthers:!1}}function B(){return{position:{my:"left top",at:"right center"},
css:{"min-width":$("#sidebar, .sidebar").first().width()||270},closeOthers:!1}}function w(c,b,d,f){if(c){var g=function(){var d=0;i(b.find(j),c.Title,o())?d++:p(b,b.find(j));i(b.find(x),c.Body,o())?d++:p(b,b.find(x));i(b.find(E),c.Tags,o())?d++:p(b,b.find(E));i(b.find(h),c.EditComment,o())?d++:p(b,b.find(h));i(b.find(y),c.Excerpt,o())?d++:p(b,b.find(y));i(b.find(a),c.Email,B())?d++:p(b,b.find(a));var g=b.find(".general-error"),k=c.General&&0<c.General.length;k||0<d?(g.length||(b.find('input[type="submit"]:visible').before('<div class="general-error-container"><div class="general-error"></div><br class="cbt" /></div>'),
g=b.find(".general-error")),k?i(g,c.General,{position:"inline",css:{"float":"left","margin-bottom":"10px"},closeOthers:!1,dismissable:!1}):(p(b,g),g.text(function(a){return 1==a.specificErrorCount?"Your "+a.postTypeName+" couldn't be submitted. Please see the error above.":"Your "+a.postTypeName+" couldn't be submitted. Please see the errors above."}({postTypeName:f,specificErrorCount:d})))):b.find(".general-error-container").remove();var m;D()&&($("#sidebar").animate({opacity:0.4},500),m=setInterval(function(){D()||
($("#sidebar").animate({opacity:1},500),clearInterval(m))},500));var n;b.find(".validation-error").each(function(){var a=$(this).offset().top;if(!n||a<n)n=a});d=function(){for(var a=0;3>a;a++)b.find(".message").animate({left:"+=5px"},100).animate({left:"-=5px"},100)};n?(g=$(".review-bar").length,n=Math.max(0,n-(g?125:30)),$("html, body").animate({scrollTop:n},d)):d()},m=function(){1!=d||b.find(E).length?g():setTimeout(m,250)};m()}}function i(a,b,d){if(!b||0==b.length||!a.length||!$("html").has(a).length)return!1;
if((b=1==b.length?b[0]:"<ul><li>"+b.join("</li><li>")+"</li></ul>")&&0<b.length){var f=a.data("error-popup");if(f&&f.is(":visible")){if(a.data("error-message")==b)return!0;f.fadeOutAndRemove()}d=StackExchange.helpers.showMessage(a,b,d);d.find("a").attr("target","_blank");a.addClass("validation-error");a.data("error-popup",d);a.data("error-message",b);d.click(A);return!0}return!1}function p(a,b){if(!b||0==b.length)return!1;var d=b.data("error-popup");d&&d.is(":visible")&&d.fadeOutAndRemove();b.removeClass("validation-error");
b.removeData("error-popup");b.removeData("error-message");a.find(".validation-error").length||a.find(".general-error-container").remove();return!0}function D(){var a=!1,b=$("#sidebar, .sidebar").first();if(!b.length)return!1;var d=b.offset().left;$(".message").each(function(){var b=$(this);if(b.offset().left+b.outerWidth()>d)return a=!0,!1});return a}var j="input#title",x="textarea.wmd-input:first",E=".tag-editor",h="input[id^=edit-comment]",y="textarea#excerpt",a="input#m-address",b=[],d=250;return{initOnBlur:n,
initOnBlurAndSubmit:function(a,b,d,f,g){n(a,b,f);var j,l=function(f){if(f.success)if(g)g(f);else{var h=window.location.href.split("#")[0],i=f.redirectTo.split("#")[0];0==i.indexOf("/")&&(i=window.location.protocol+"//"+window.location.hostname+i);j=!0;window.location=f.redirectTo;h.toLowerCase()==i.toLowerCase()&&window.location.reload(!0)}else f.captchaHtml?StackExchange.captcha.init(f.captchaHtml,l):f.errors?w(f.errors,a,b,d):a.find('input[type="submit"]:visible').parent().showErrorMessage(f.message)};
a.submit(function(){if(a.find("#answer-from-ask").is(":checked"))return!0;var b=a.find(h);if("[Edit removed during grace period]"==$.trim(b.val()))return i(b,["Comment reserved for system use. Please use an appropriate comment."],o()),!1;A();StackExchange.navPrevention&&StackExchange.navPrevention.stop();a.find('input[type="submit"]:visible').parent().addSpinner();StackExchange.helpers.disableSubmitButton(a);setTimeout(function(){$.ajax({type:"POST",dataType:"json",data:a.serialize(),url:a.attr("action"),
success:l,error:function(){a.find('input[type="submit"]:visible').parent().showErrorMessage("An error occurred submitting the "+d+".")},complete:function(){StackExchange.helpers.removeSpinner();j||StackExchange.helpers.enableSubmitButton(a)}})},0);return!1})},showErrorsAfterSubmission:w,getSidebarPopupOptions:o}}();